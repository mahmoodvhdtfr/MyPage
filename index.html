<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>مستندات برد Main دستگاه گرم</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Tahoma', 'Arial', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            background: rgba(255, 255, 255, 0.95);
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            margin-bottom: 30px;
            text-align: center;
        }
        
        h1 {
            color: #2c3e50;
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        .subtitle {
            color: #7f8c8d;
            font-size: 1.2em;
        }
        
        .section {
            background: rgba(255, 255, 255, 0.95);
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            margin-bottom: 25px;
        }
        
        h2 {
            color: #3498db;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
            margin-bottom: 20px;
            font-size: 1.8em;
        }
        
        h3 {
            color: #2c3e50;
            margin: 20px 0 15px 0;
            font-size: 1.4em;
        }
        
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .card {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            border-left: 5px solid #3498db;
            transition: transform 0.3s ease;
        }
        
        .card:hover {
            transform: translateY(-5px);
        }
        
        .status-indicator {
            display: flex;
            align-items: center;
            margin: 10px 0;
            padding: 15px;
            border-radius: 8px;
            background: white;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
        }
        
        .led {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            margin-left: 15px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.3);
        }
        
        .led-green {
            background: #27ae60;
            box-shadow: 0 0 15px #27ae60;
        }
        
        .led-yellow {
            background: #f39c12;
            box-shadow: 0 0 15px #f39c12;
        }
        
        .led-off {
            background: #bdc3c7;
        }
        
        .code-block {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 20px;
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            overflow-x: auto;
            margin: 15px 0;
            direction: ltr;
            text-align: left;
        }
        
        .highlight {
            background: #fff3cd;
            padding: 10px 15px;
            border-right: 5px solid #ffc107;
            border-radius: 5px;
            margin: 15px 0;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        th, td {
            padding: 15px;
            text-align: right;
            border-bottom: 1px solid #ddd;
        }
        
        th {
            background: #3498db;
            color: white;
            font-weight: bold;
        }
        
        tr:hover {
            background: #f5f5f5;
        }
        
        .logic-flow {
            background: #e8f4f8;
            padding: 25px;
            border-radius: 10px;
            margin: 20px 0;
        }
        
        .step {
            display: flex;
            align-items: center;
            margin: 15px 0;
            padding: 15px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
        }
        
        .step-number {
            background: #3498db;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-left: 15px;
        }
        
        footer {
            text-align: center;
            padding: 30px;
            color: white;
            margin-top: 50px;
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            h1 {
                font-size: 2em;
            }
            
            .grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>🚀 مستندات برد Main دستگاه گرم</h1>
            <p class="subtitle"> راه اندازی انتخاب محصول و برد  Main دستگاه گرم با برد پشت فنر لونک  </p>
        </header>

        <section class="section">
            <h2>📋 معرفی پروژه</h2>
            <p>در این پروژه سعی شده از برد پشت فنر دستگاه لونک برای کنترل و انتخاب محصول دستگاه نوشیدنی گرم استفاده بشه در این برد  از میکروکنترلر ATMega8A و مالتی پلکسر HEF4051BT  استفاده شده</p>
            
            <div class="highlight">
                <strong>💡 ویژگی‌های کلیدی:</strong>
                <ul style="margin-right: 20px; margin-top: 10px;">
                    <li>استفاده از تاک سوئیچ های شماره 1 تا 4 برای انتخاب محصول</li>
                    <li>استفاده از موتور های شماره 1 تا 4 برای کنستر</li>
                    <li>استفاده از موتور های شماره 5 و 6 برای میکسر و شیر برقی</li>
					<li>استفاده از جامپر A برای  دریافت گزارشات مربوط به دما و مقدار آب از برد رله</li>
					<li>استفاده از جامپر B برای  دریافت گزارش مربوط به وجود لیوان در لیوان انداز</li>
					<li>استفاده از موتور شماره 7 برای لیوان انداز</li>
                    <li>مدیریت خطا با LED های نشانگر</li>
                    <li>ساختار ماژولار و قابل توسعه</li>
                </ul>
            </div>
        </section>

        <section class="section">
            <h2>🔧 مشخصات فنی</h2>
            
            <div class="grid">
                <div class="card">
                    <h3>🧠️ میکروکنترلر</h3>
                    <p><strong>ATMega8A</strong><br>
                    فرکانس: 8MHz<br>
                    حافظه فلش: 8KB<br>
                    پورت‌های I/O: 23</p>
                </div>
                
                <div class="card">
                    <h3>🧊 مالتی پلکسر</h3>
                    <p><strong>HEF4051BT</strong><br>
                    نوع: 8 به 1<br>
                    ورودی: 3 خط آدرس<br>
                    خروجی: 1 خط</p>
                </div>
                
                <div class="card">
                    <h3>⚡ تغذیه</h3>
                    <p>ولتاژ: 24V DC<br>
                    جریان: حداکثر 2A<br>
</p>
                </div>
            </div>
        </section>

<section class="section">
    <h2>🔌 جامپرهای ارتباطی</h2>
    
    <div class="grid">
        <div class="card">
            <h3>🔗 جامپر A</h3>
            <p><strong>اتصال به برد رله</strong><br>
            • دریافت گزارش دمای آب<br>
            • دریافت گزارش مقدار آب<br>
            • وضعیت سیستم گرمایش</p>
        </div>
        
        <div class="card">
            <h3>🔗 جامپر B</h3>
            <p><strong>اتصال به لیوان انداز</strong><br>
            • گزارش وجود لیوان<br>
            • کنترل موتور لیوان انداز<br>
        </div>
    </div>
</section>


        <!-- بخش جدید: لیست کامل پین‌ها -->
        <section class="section">
            <h2>📌 لیست کامل تاک سوئیچ‌ها، موتورها و پایه‌های متناظر</h2>

            <div class="pin-diagram">
                <h3>🔘 تاک سوئیچ‌ها (ورودی‌ها)</h3>
                <table>
                    <tr>
                        <th>شماره تاک سوئیچ</th>
                        <th>کانال مالتی پلکسر</th>
                        <th>آدرس (A2 A1 A0)</th>
                        <th>پایه مالتی پلکسر</th>
                    </tr>
                    <tr>
                        <td>تاک سوئیچ 1</td>
                        <td>Y7</td>
                        <td>1 1 1</td>
                        <td>پین 4</td>
                    </tr>
                    <tr>
                        <td>تاک سوئیچ 2</td>
                        <td>Y6</td>
                        <td>1 1 0</td>
                        <td>پین 2</td>
                    </tr>
                    <tr>
                        <td>تاک سوئیچ 3</td>
                        <td>Y5</td>
                        <td>1 0 1</td>
                        <td>پین 15</td>
                    </tr>
                    <tr>
                        <td>تاک سوئیچ 4</td>
                        <td>Y4</td>
                        <td>1 0 0</td>
                        <td>پین 14</td>
                    </tr>
                    <tr>
                        <td>تاک سوئیچ 5</td>
                        <td>Y3</td>
                        <td>0 1 1</td>
                        <td>پین 13</td>
                    </tr>
                    <tr>
                        <td>تاک سوئیچ 6</td>
                        <td>Y2</td>
                        <td>0 1 0</td>
                        <td>پین 12</td>
                    </tr>
                    <tr>
                        <td>تاک سوئیچ 7</td>
                        <td>Y1</td>
                        <td>0 0 1</td>
                        <td>پین 1</td>
                    </tr>
                    <tr>
                        <td>تاک سوئیچ 8</td>
                        <td>Y0</td>
                        <td>0 0 0</td>
                        <td>پین 5</td>
                    </tr>
                </table>
            </div>

            <div class="pin-diagram">
                <h3>⚙️ موتورها (خروجی‌ها)</h3>
                <table>
                    <tr>
                        <th>شماره موتور</th>
                        <th>پایه میکرو ATMega8A</th>
                        <th>پورت</th>
                        <th>عملکرد</th>
                    </tr>
                    <tr>
                        <td>موتور 1</td>
                        <td>PD7</td>
                        <td>پین 21</td>
                        <td>کنستر اول</td>
                    </tr>
                    <tr>
                        <td>موتور 2</td>
                        <td>PD6</td>
                        <td>پین 20</td>
                        <td>کنستر دوم</td>
                    </tr>
                    <tr>
                        <td>موتور 3</td>
                        <td>PC5</td>
                        <td>پین 28</td>
                        <td>کنستر سوم</td>
                    </tr>
                    <tr>
                        <td>موتور 4</td>
                        <td>PC4</td>
                        <td>پین 27</td>
                        <td>کنستر چهارم</td>
                    </tr>
                    <tr>
                        <td>موتور 5</td>
                        <td>PC3</td>
                        <td>پین 26</td>
                        <td>میکسر</td>
                    </tr>
                    <tr>
                        <td>موتور 6</td>
                        <td>PC2</td>
                        <td>پین 25</td>
                        <td>شیر برقی</td>
                    </tr>
                    <tr>
                        <td>موتور 7</td>
                        <td>PC1</td>
                        <td>پین 24</td>
                        <td>لیوان انداز</td>
                    </tr>
                    <tr>
                        <td>موتور 8</td>
                        <td>PC0</td>
                        <td>پین 23</td>
                        <td>آماده به کار</td>
                    </tr>
                </table>
            </div>

            <div class="pin-diagram">
                <h3>🔌 اتصالات مالتی پلکسر (HEF4051BT)</h3>
                <table>
                    <tr>
                        <th>پایه مالتی پلکسر</th>
                        <th>عملکرد</th>
                        <th>اتصال به میکرو</th>
                    </tr>
                    <tr>
                        <td>پین 9 (A2)</td>
                        <td>آدرس 2</td>
                        <td>PB5</td>
                    </tr>
                    <tr>
                        <td>پین 10 (A1)</td>
                        <td>آدرس 1</td>
                        <td>PB4</td>
                    </tr>
                    <tr>
                        <td>پین 11 (A0)</td>
                        <td>آدرس 0</td>
                        <td>PB3</td>
                    </tr>
                    <tr>
                        <td>پین 3 (Z)</td>
                        <td>خروجی</td>
                        <td>PB0</td>
                    </tr>
                </table>
            </div>

            <div class="grid">
                <div class="card">
                    <h3>📥 ورودی‌های مستقیم</h3>
                    <table>
                        <tr>
                            <th>ورودی</th>
                            <th>پایه میکرو</th>
                            <th>پورت</th>
                        </tr>
                        <tr>
                            <td>ورودی 9</td>
                            <td>PD3</td>
                            <td>پین 17</td>
                        </tr>
                        <tr>
                            <td>ورودی 10</td>
                            <td>PD4</td>
                            <td>پین 18</td>
                        </tr>
                    </table>
                </div>
                
                <div class="card">
                    <h3>📤 خروجی‌های مستقیم</h3>
                    <table>
                        <tr>
                            <th>خروجی</th>
                            <th>پایه میکرو</th>
                            <th>پورت</th>
                        </tr>
                        <tr>
                            <td>L1</td>
                            <td>PB1</td>
                            <td>پین 16</td>
                        </tr>
                        <tr>
                            <td>L2</td>
                            <td>PB2</td>
                            <td>پین 15</td>
                        </tr>
                    </table>
                </div>
                
                <div class="card">
                    <h3>🔋 پایه‌های تغذیه</h3>
                    <ul style="margin-right: 20px; margin-top: 10px;">
                        <li><strong>VCC</strong>: پین 7 و 20</li>
                        <li><strong>GND</strong>: پین 8 و 22</li>
                        <li><strong>RESET</strong>: پین 1</li>
                    </ul>
                </div>
            </div>
        </section>


        <section class="section">
            <h2>🎯 نشانگرهای وضعیت (LED ها)</h2>
            
            <div class="status-indicator">
                <div class="led led-green"></div>
                <div>
                    <strong>L1 - LED سبز رنگ</strong><br>
                    <span style="color: #e74c3c;">● وقتی روشن است: مشکل از نبود آب یا سرد بودن آب هستش!</span><br>
                    <span style="color: #27ae60;">● وقتی خاموش است: سیستم آب سالم است ✅</span>
                </div>
            </div>
            
            <div class="status-indicator">
                <div class="led led-yellow"></div>
                <div>
                    <strong>L2 - LED زرد رنگ</strong><br>
                    <span style="color: #e74c3c;">● وقتی روشن است: مشکل از نبود لیوان هستش!</span><br>
                    <span style="color: #27ae60;">● وقتی خاموش است: دستگاه لیوان دارد ✅</span>
                </div>
            </div>

            <div class="highlight">
                <strong>📝 نکته مهم:</strong>
                <p>در این سیستم وقتی LED روشن است نشان‌دهنده خطا می‌باشد و وقتی خاموش است نشان‌دهنده وضعیت نرمال است.</p>
            </div>

            <h3>🔢 جدول وضعیت‌های سیستم</h3>
            <table>
                <tr>
                    <th>وضعیت</th>
                    <th>L1 (سبز)</th>
                    <th>L2 (زرد)</th>
                    <th>معنی</th>
                    <th>عملکرد سیستم</th>
                </tr>
                <tr>
                    <td>ایده‌آل</td>
                    <td>✅ خاموش</td>
                    <td>✅ خاموش</td>
                    <td>سیستم کامل آماده</td>
                    <td>✅ فعال - تمام تاک سوئیچ‌ها کار می‌کنند</td>
                </tr>
                <tr>
                    <td>خطای آب</td>
                    <td>🔴 روشن</td>
                    <td>✅ خاموش</td>
                    <td>مشکل در سیستم آب</td>
                    <td>❌ غیرفعال - تاک سوئیچ‌ها قفل شده</td>
                </tr>
                <tr>
                    <td>خطای لیوان</td>
                    <td>✅ خاموش</td>
                    <td>🔴 روشن</td>
                    <td>لیوان موجود نیست</td>
                    <td>❌ غیرفعال - تاک سوئیچ‌ها قفل شده</td>
                </tr>
                <tr>
                    <td>خطای کامل</td>
                    <td>🔴 روشن</td>
                    <td>🔴 روشن</td>
                    <td>هر دو مشکل وجود دارد</td>
                    <td>❌ غیرفعال - تاک سوئیچ‌ها قفل شده</td>
                </tr>
            </table>
        </section>

        <section class="section">
            <h2>🔗 اتصالات و پین‌ها</h2>
            
            <h3>اتصالات مالتی پلکسر</h3>
            <table>
                <tr>
                    <th>پین مالتی پلکسر</th>
                    <th>عملکرد</th>
                    <th>اتصال به میکرو</th>
                </tr>
                <tr>
                    <td>پین 9 (A2)</td>
                    <td>آدرس 2</td>
                    <td>PB5</td>
                </tr>
                <tr>
                    <td>پین 10 (A1)</td>
                    <td>آدرس 1</td>
                    <td>PB4</td>
                </tr>
                <tr>
                    <td>پین 11 (A0)</td>
                    <td>آدرس 0</td>
                    <td>PB3</td>
                </tr>
                <tr>
                    <td>پین 3 (Z)</td>
                    <td>خروجی</td>
                    <td>PB0</td>
                </tr>
            </table>

            <h3>موتورها</h3>
            <table>
                <tr>
                    <th>موتور</th>
                    <th>پایه میکرو</th>
                    <th>پورت</th>
                    <th>عملکرد</th>
                </tr>
                <tr>
                    <td>موتور 1</td>
                    <td>PD7</td>
                    <td>پین 21</td>
                    <td>سیکل‌های 1 و 2</td>
                </tr>
                <tr>
                    <td>موتور 2</td>
                    <td>PD6</td>
                    <td>پین 20</td>
                    <td>سیکل‌های 3 و 4</td>
                </tr>
                <tr>
                    <td>موتور 3</td>
                    <td>PC5</td>
                    <td>پین 28</td>
                    <td>سیکل‌های 5 و 6</td>
                </tr>
                <tr>
                    <td>موتور 4</td>
                    <td>PC4</td>
                    <td>پین 27</td>
                    <td>سیکل‌های 7 و 8</td>
                </tr>
                <tr>
                    <td>موتور 5</td>
                    <td>PC3</td>
                    <td>پین 26</td>
                    <td>موتور دوم سیکل‌های فرد</td>
                </tr>
                <tr>
                    <td>موتور 6</td>
                    <td>PC2</td>
                    <td>پین 25</td>
                    <td>موتور دوم سیکل‌های زوج</td>
                </tr>
                <tr>
                    <td>موتور 7</td>
                    <td>PC1</td>
                    <td>پین 24</td>
                    <td>کنترل کننده بادامک</td>
                </tr>
            </table>
        </section>

        <section class="section">
            <h2>🎛️ منطق کاری سیستم</h2>
            
            <div class="logic-flow">
                <h3>📈 فلوچارت کاری</h3>
                
                <div class="step">
                    <div class="step-number">1</div>
                    <div>
                        <strong>بررسی وضعیت LED ها</strong><br>
                        • L1 خاموش؟ ✅ سیستم آب سالم است<br>
                        • L2 خاموش؟ ✅ لیوان موجود است<br>
                        فقط وقتی هر دو LED خاموش باشند سیستم فعال می‌شود
                    </div>
                </div>
                
                <div class="step">
                    <div class="step-number">2</div>
                    <div>
                        <strong>انتخاب سیکل توسط کاربر</strong><br>
                        کاربر با فشردن یکی از تاک سوئیچ‌های 1 تا 4 سیکل مورد نظر را انتخاب می‌کند
                    </div>
                </div>
                
                <div class="step">
                    <div class="step-number">3</div>
                    <div>
                        <strong>فعال شدن موتور 7 و بادامک</strong><br>
                        موتور 7 روشن شده و بادامک را می‌چرخاند
                    </div>
                </div>
                
                <div class="step">
                    <div class="step-number">4</div>
                    <div>
                        <strong>فشرده شدن تاک سوئیچ 7 توسط بادامک</strong><br>
                        بادامک پس از یک دور چرخش، تاک سوئیچ 7 را فشار می‌دهد
                    </div>
                </div>
                
                <div class="step">
                    <div class="step-number">5</div>
                    <div>
                        <strong>اجرای سیکل انتخابی</strong><br>
                        سیستم بر اساس سیکل انتخاب شده، موتورهای مربوطه را به ترتیب فعال می‌کند
                    </div>
                </div>
            </div>

            <h3>🔢 سیکل‌های کاری</h3>
            <table>
                <tr>
                    <th>تاک سوئیچ</th>
                    <th>سیکل</th>
                    <th>موتور اول</th>
                    <th>موتور دوم</th>
                </tr>
                <tr>
                    <td>تاک سوئیچ 1 (Y7)</td>
                    <td>سیکل 1</td>
                    <td>موتور 1</td>
                    <td>موتور 5</td>
                </tr>
                <tr>
                    <td>تاک سوئیچ 2 (Y6)</td>
                    <td>سیکل 2</td>
                    <td>موتور 2</td>
                    <td>موتور 5</td>
                </tr>
                <tr>
                    <td>تاک سوئیچ 3 (Y5)</td>
                    <td>سیکل 3</td>
                    <td>موتور 3</td>
                    <td>موتور 6</td>
                </tr>
                <tr>
                    <td>تاک سوئیچ 4 (Y4)</td>
                    <td>سیکل 4</td>
                    <td>موتور 4</td>
                    <td>موتور 6</td>
                </tr>
            </table>
        </section>
		
		
<!-- اضافه کردن این بخش بعد از بخش سیکل‌های کاری -->

<section class="section">
    <h2>🥤 توضیح عملکرد محصولات</h2>
    
    <table>
        <tr>
            <th>تاک سوئیچ</th>
            <th>محصول</th>
            <th>موتور کنستر</th>
            <th>موتور میکسر/شیر</th>
            <th>توضیح</th>
        </tr>
        <tr>
            <td>1 (Y7)</td>
            <td>محصول 1</td>
            <td>موتور 1</td>
            <td>موتور 5</td>
            <td>لیوان انداز + کنستر اول + میکسر اول + شیربرقی اول</td>
        </tr>
        <tr>
            <td>2 (Y6)</td>
            <td>محصول 2</td>
            <td>موتور 2</td>
            <td>موتور 5</td>
            <td>لیوان انداز + کنستر دوم+ میکسر اول + شیربرقی اول</td>
        </tr>
        <tr>
            <td>3 (Y5)</td>
            <td>محصول 3</td>
            <td>موتور 3</td>
            <td>موتور 6</td>
            <td>لیوان انداز + کنستر سوم + میکسر دوم + شیربرقی دوم</td>
        </tr>
        <tr>
            <td>4 (Y4)</td>
            <td>محصول 4</td>
            <td>موتور 4</td>
            <td>موتور 6</td>
            <td>لیوان انداز + کنستر چهارم + میکسر دوم + شیربرقی دوم</td>
        </tr>
    </table>
</section>


        <section class="section">
            <h2>⚙️ تنظیمات تاخیرها</h2>
            
            <div class="grid">
                <div class="card">
                    <h3>⏱️ Debounce_Delay</h3>
                    <p><strong>200 میلی‌ثانیه</strong><br>
                    برای جلوگیری از تشخیص چندباره تاک سوئیچ</p>
                </div>
                
                <div class="card">
                    <h3>⏱️ Motor7_Off_Delay</h3>
                    <p><strong>500 میلی‌ثانیه</strong><br>
                    تاخیر بین فشرده شدن تاک سوئیچ 7 و خاموش شدن موتور 7</p>
                </div>
                
                <div class="card">
                    <h3>⏱️ Second_Motor_Delay</h3>
                    <p><strong>1000 میلی‌ثانیه</strong><br>
                    تاخیر بین روشن شدن موتور اول و دوم</p>
                </div>
                
                <div class="card">
                    <h3>⏱️ Second_Motor_Run_Time</h3>
                    <p><strong>2000 میلی‌ثانیه</strong><br>
                    مدت زمان کارکرد موتور دوم</p>
                </div>
            </div>
        </section>

        <section class="section">
            <h2>📝 کد مرجع</h2>
            
            <div class="code-block">
// تعریف تاخیرهای سیستم<br>
Const Debounce_Delay = 200<br>
Const Motor7_Off_Delay = 500<br>
Const Second_Motor_Delay = 1000<br>
Const Second_Motor_Run_Time = 2000<br>
Const Final_Delay = 1000<br>
<br>
// پیکربندی پورت‌ها<br>
Config Pinb.0 = Input<br>
Config Portb.3 = Output<br>
Config Portb.4 = Output<br>
// ... بقیه کد<br>
            </div>
            
            <div class="highlight">
                <strong>📥 دانلود کد کامل:</strong>
                <p>کد کامل پروژه در قالب فایل BASCOM-AVR آماده دانلود است.</p>
                <button onclick="downloadCode()" style="background: #3498db; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; margin-top: 10px;">دانلود کد کامل</button>
            </div>
        </section>

        <section class="section">
            <h2>🚨 عیب‌یابی و نکات فنی</h2>
            
            <div class="grid">
                <div class="card">
                    <h3>🔴 مشکل: L1 روشن است</h3>
                    <p><strong>علت:</strong> مشکل در سیستم آب (نبود آب یا سرد بودن آب)<br>
                    <strong>راه حل:</strong> بررسی منبع آب و دمای آب</p>
                </div>
                
                <div class="card">
                    <h3>🔴 مشکل: L2 روشن است</h3>
                    <p><strong>علت:</strong> لیوان موجود نیست<br>
                    <strong>راه حل:</strong> قرار دادن لیوان در دستگاه</p>
                </div>
                
                
                <div class="card">
                    <h3>🔴 مشکل: سیستم تاک سوئیچ‌ها را تشخیص نمی‌دهد</h3>
                    <p><strong>علت:</strong> اشتباه در آدرس دهی مالتی پلکسر<br>
                    <strong>راه حل:</strong> بررسی اتصالات A0, A1, A2</p>
                </div>
            </div>
        </section>
    </div>

    <footer>

    </footer>

    <script>
        function downloadCode() {
            const codeContent = `$regfile = "m8def.dat"
$crystal = 8000000

' ==================== تعریف تاخیرهای سیستم ====================
Const Debounce_Delay = 200      ' تاخیر برای جلوگیری از تشخیص چندباره تاک سوئیچ
Const Motor7_Off_Delay = 500    ' تاخیر بین فشرده شدن تاک سوئیچ 7 و خاموش شدن موتور 7
Const Second_Motor_Delay = 1000 ' تاخیر بین روشن شدن موتور اول و روشن شدن موتور دوم
Const Second_Motor_Run_Time = 2000 ' مدت زمان کارکرد موتور دوم
Const Final_Delay = 1000        ' تاخیر نهایی برای اطمینان از پایان کامل سیکل

' ==================== پیکربندی پورت‌های میکروکنترلر ====================
Config Pinb.0 = Input           ' پین Z مالتی پلکسر - برای خواندن وضعیت تمام تاک سوئیچ‌ها
Config Portb.3 = Output         ' پین A0 مالتی پلکسر - بیت 0 آدرس دهی
Config Portb.4 = Output         ' پین A1 مالتی پلکسر - بیت 1 آدرس دهی
Config Portb.5 = Output         ' پین A2 مالتی پلکسر - بیت 2 آدرس دهی

Config Portc.1 = Output         ' موتور 7 - کنترل کننده اصلی سیستم بادامک
Config Portd.7 = Output         ' موتور 1 - اولین موتور در سیکل 1
Config Portd.6 = Output         ' موتور 2 - اولین موتور در سیکل 2
Config Portc.5 = Output         ' موتور 3 - اولین موتور در سیکل 3
Config Portc.4 = Output         ' موتور 4 - اولین موتور در سیکل 4
Config Portc.3 = Output         ' موتور 5 - موتور دوم در سیکل‌های 1 و 2
Config Portc.2 = Output         ' موتور 6 - موتور دوم در سیکل‌های 3 و 4

Config Pind.3 = Input           ' ورودی PD3 - وضعیت سیستم آب (0: مشکل, 1: سالم)
Config Pind.4 = Input           ' ورودی PD4 - وضعیت لیوان (0: موجود, 1: عدم موجود)

Config Portb.1 = Output         ' خروجی PB1 - L1 (LED سبز) نشان‌دهنده مشکل آب
Config Portb.2 = Output         ' خروجی PB2 - L2 (LED زرد) نشان‌دهنده مشکل لیوان

' ==================== راه‌اندازی اولیه سیستم ====================
Portb.0 = 1                     ' فعال کردن پول-آپ برای پین Z مالتی پلکسر
Portd.3 = 1                     ' فعال کردن پول-آپ برای PD3
Portd.4 = 1                     ' فعال کردن پول-آپ برای PD4

' موتورها از ابتدا روشن (لاژیک معکوس به دلیل اپتوکوپلر)
Set Portc.1    ' موتور 7 خاموش - کنترل کننده بادامک
Set Portd.7    ' موتور 1 خاموش 
Set Portd.6    ' موتور 2 خاموش
Set Portc.5    ' موتور 3 خاموش
Set Portc.4    ' موتور 4 خاموش
Set Portc.3    ' موتور 5 خاموش
Set Portc.2    ' موتور 6 خاموش

' LED ها در حالت عادی خاموش هستند (وضعیت نرمال)
Reset Portb.1  ' L1 خاموش - سیستم آب سالم است
Reset Portb.2  ' L2 خاموش - لیوان موجود است

' ==================== متغیرهای کنترلی سیستم ====================
Dim Cycle_Type As Byte          ' ذخیره نوع سیکل انتخاب شده (1 تا 4)
Dim Motor7_Active As Bit        ' پرچم نشان‌دهنده فعال بودن موتور 7 و بادامک

' ==================== حلقه اصلی برنامه ====================
Main:
    ' سیستم فعال است اگر: (PD3 = 1) AND (PD4 = 0)
    ' یعنی: سیستم آب سالم است AND لیوان موجود است
    If Pind.3 = 1 And Pind.4 = 0 Then
        ' ✅ سیستم فعال است - تمام شرایط برقرار است
        
        ' خاموش کردن LED های نشانگر خطا (وضعیت نرمال)
        Reset Portb.1   ' L1 خاموش - سیستم آب سالم است
        Reset Portb.2   ' L2 خاموش - لیوان موجود است
        
        ' ========== فاز اول: شروع سیکل توسط کاربر ==========
        ' اگر موتور 7 غیرفعال باشد، تاک سوئیچ‌های 1 تا 4 را برای شروع سیکل جدید بررسی کن
        If Motor7_Active = 0 Then
            
            ' ---------- تاک سوئیچ 1 (Y7) - سیکل موتور 1 و 5 ----------
            Set Portb.5 : Set Portb.4 : Set Portb.3  ' آدرس دهی کانال Y7: A2=1, A1=1, A0=1
            Waitms 50                                ' تاخیر برای پایدار شدن سیگنال مالتی پلکسر
            If Pinb.0 = 0 Then                       ' اگر تاک سوئیچ 1 فشرده شد
                Reset Portc.1                        ' روشن کردن موتور 7 (کنترل کننده بادامک)
                Cycle_Type = 1                       ' تنظیم سیکل نوع 1: موتور 1 + موتور 5
                Motor7_Active = 1                    ' فعال کردن پرچم موتور 7
                Waitms Debounce_Delay                ' تاخیر دبیانسی برای جلوگیری از تشخیص چندباره
            End If

            ' ---------- تاک سوئیچ 2 (Y6) - سیکل موتور 2 و 5 ----------
            Set Portb.5 : Set Portb.4 : Reset Portb.3  ' آدرس دهی کانال Y6: A2=1, A1=1, A0=0
            Waitms 50
            If Pinb.0 = 0 Then
                Reset Portc.1        ' روشن کردن موتور 7
                Cycle_Type = 2       ' تنظیم سیکل نوع 2: موتور 2 + موتور 5
                Motor7_Active = 1
                Waitms Debounce_Delay
            End If

            ' ---------- تاک سوئیچ 3 (Y5) - سیکل موتور 3 و 6 ----------
            Set Portb.5 : Reset Portb.4 : Set Portb.3  ' آدرس دهی کانال Y5: A2=1, A1=0, A0=1
            Waitms 50
            If Pinb.0 = 0 Then
                Reset Portc.1        ' روشن کردن موتور 7
                Cycle_Type = 3       ' تنظیم سیکل نوع 3: موتور 3 + موتور 6
                Motor7_Active = 1
                Waitms Debounce_Delay
            End If

            ' ---------- تاک سوئیچ 4 (Y4) - سیکل موتور 4 و 6 ----------
            Set Portb.5 : Reset Portb.4 : Reset Portb.3  ' آدرس دهی کانال Y4: A2=1, A1=0, A0=0
            Waitms 50
            If Pinb.0 = 0 Then
                Reset Portc.1        ' روشن کردن موتور 7
                Cycle_Type = 4       ' تنظیم سیکل نوع 4: موتور 4 + موتور 6
                Motor7_Active = 1
                Waitms Debounce_Delay
            End If
        End If
        
        ' ========== فاز دوم: اجرای سیکل توسط بادامک ==========
        ' اگر موتور 7 فعال باشد، منتظر فشرده شدن تاک سوئیچ 7 توسط بادامک باش
        If Motor7_Active = 1 Then
            
            ' ---------- تاک سوئیچ 7 (Y1) - فعال شده توسط بادامک ----------
            Reset Portb.5 : Reset Portb.4 : Set Portb.3  ' آدرس دهی کانال Y1: A2=0, A1=0, A0=1
            Waitms 50
            If Pinb.0 = 0 Then       ' اگر تاک سوئیچ 7 توسط بادامک فشرده شد
                Waitms Motor7_Off_Delay  ' تاخیر قبل از خاموش کردن موتور 7
                Set Portc.1              ' خاموش کردن موتور 7 (بادامک)
                
                ' اجرای سیکل کاری بر اساس نوع سیکل انتخاب شده توسط کاربر
                Select Case Cycle_Type
                    
                    Case 1:  ' سیکل نوع 1: موتور 1 و موتور 5
                        Reset Portd.7                ' روشن کردن موتور 1
                        Waitms Second_Motor_Delay    ' تاخیر قبل از روشن کردن موتور دوم
                        Reset Portc.3                ' روشن کردن موتور 5
                        Waitms Second_Motor_Run_Time ' مدت زمان کارکرد موتور 5
                        Set Portd.7                  ' خاموش کردن موتور 1
                        Waitms Final_Delay           ' تاخیر نهایی
                        Set Portc.3                  ' خاموش کردن موتور 5
                        
                    Case 2:  ' سیکل نوع 2: موتور 2 و موتور 5
                        Reset Portd.6                ' روشن کردن موتور 2
                        Waitms Second_Motor_Delay
                        Reset Portc.3                ' روشن کردن موتور 5
                        Waitms Second_Motor_Run_Time
                        Set Portd.6                  ' خاموش کردن موتور 2
                        Waitms Final_Delay
                        Set Portc.3                  ' خاموش کردن موتور 5
                        
                    Case 3:  ' سیکل نوع 3: موتور 3 و موتور 6
                        Reset Portc.5                ' روشن کردن موتور 3
                        Waitms Second_Motor_Delay
                        Reset Portc.2                ' روشن کردن موتور 6
                        Waitms Second_Motor_Run_Time
                        Set Portc.5                  ' خاموش کردن موتور 3
                        Waitms Final_Delay
                        Set Portc.2                  ' خاموش کردن موتور 6
                        
                    Case 4:  ' سیکل نوع 4: موتور 4 و موتور 6
                        Reset Portc.4                ' روشن کردن موتور 4
                        Waitms Second_Motor_Delay
                        Reset Portc.2                ' روشن کردن موتور 6
                        Waitms Second_Motor_Run_Time
                        Set Portc.4                  ' خاموش کردن موتور 4
                        Waitms Final_Delay
                        Set Portc.2                  ' خاموش کردن موتور 6
                End Select
                
                ' ریست متغیرها برای آماده‌سازی سیکل بعدی
                Cycle_Type = 0       ' پاک کردن نوع سیکل
                Motor7_Active = 0    ' غیرفعال کردن پرچم موتور 7
            End If
        End If

    Else
        ' ❌ سیستم غیرفعال است - یکی از شرایط فعال بودن برقرار نیست
        
        ' روشن کردن LED های نشانگر متناسب با نوع خطا
        If Pind.3 = 0 Then
            Set Portb.1   ' روشن کردن L1 - نشان‌دهنده مشکل در سیستم آب
        Else
            Reset Portb.1 ' خاموش کردن L1 - سیستم آب سالم است
        End If
        
        If Pind.4 = 1 Then
            Set Portb.2   ' روشن کردن L2 - نشان‌دهنده عدم وجود لیوان
        Else
            Reset Portb.2 ' خاموش کردن L2 - لیوان موجود است
        End If
        
    End If
    
    ' بازگشت به ابتدای حلقه اصلی برای ادامه نظارت بر سیستم
    Goto Main
End`;

            const blob = new Blob([codeContent], { type: 'text/plain' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'Motor_Control_System.bas';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
        }
    </script>
</body>
</html>
